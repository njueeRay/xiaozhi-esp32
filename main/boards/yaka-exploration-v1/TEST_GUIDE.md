# YAKA Exploration V1 测试指南

## 功能测试清单

### 1. 硬件初始化测试
- [ ] ESP32-S3启动正常
- [ ] I2C总线初始化成功
- [ ] XL9555 GPIO扩展器通信正常
- [ ] 所有GPIO引脚配置正确

### 2. 按键功能测试

#### 按键A (GPIO_NUM_42)
- [ ] **长按测试 (>1秒)**
  - 按住按键A超过1秒
  - 观察串口日志输出："Key A long pressed (>1s) - Power toggle"
  - 验证电源状态切换
  
- [ ] **短按测试 (90-250ms)**
  - 快速按下松开按键A
  - 观察串口日志输出："Key A short click (90-250ms) - Toggle LEDs"
  - 验证LED状态切换

#### 按键B (GPIO_NUM_15)
- [ ] **长按测试 (>1秒)**
  - 按住按键B超过1秒
  - 观察串口日志输出："Key B long pressed (>1s) - Power toggle"
  - 验证电源状态切换
  
- [ ] **短按测试**
  - 快速按下松开按键B
  - 观察串口日志输出："Key B short click - System functions"
  - 验证系统功能响应

### 3. LED功能测试

#### 5个单色LED测试 (GPIO 37, 36, 35, 4, 5)
- [ ] **启动序列测试**
  - 系统启动时观察LED1-LED5逐个点亮
  - 每个LED间隔200ms点亮
  - 启动完成后所有LED保持点亮状态
  
- [ ] **切换功能测试**
  - 短按按键A
  - 观察所有5个LED同时关闭或点亮
  - 重复测试确认切换功能正常
  
- [ ] **亮度控制测试**
  - 验证LED亮度设置为50%
  - 测试不同亮度级别

#### RGB LED测试 (GPIO_NUM_8)
- [ ] **启动指示测试**
  - 启动完成后RGB LED显示蓝色
  
- [ ] **关机指示测试**
  - 长按按键触发关机时RGB LED显示红色
  
- [ ] **状态指示测试**
  - 验证RGB LED能正确响应系统状态变化

### 4. 电源管理测试

#### PWR_EN控制 (GPIO_NUM_41)
- [ ] **开机测试**
  - 验证PWR_EN引脚在开机时输出高电平
  - 观察串口日志："System powered on successfully"
  
- [ ] **关机测试**
  - 长按任意按键触发关机
  - 验证PWR_EN引脚输出低电平
  - 观察串口日志："System powered off successfully"
  
- [ ] **开关机序列测试**
  - 验证完整的开关机序列执行正确
  - 模块启用/禁用 -> LED序列 -> 电源控制

### 5. 模块控制测试

#### 4G模块控制 (GPIO_NUM_14)
- [ ] **启用测试**
  - 系统开机时4G_EN引脚输出高电平
  - 观察串口日志："Enabling modules (4G and MIC)"
  
- [ ] **禁用测试**
  - 系统关机时4G_EN引脚输出低电平
  - 观察串口日志："Disabling modules (4G and MIC)"

#### MIC模块控制 (GPIO_NUM_9)
- [ ] **启用测试**
  - 系统开机时MIC_EN引脚输出高电平
  
- [ ] **禁用测试**
  - 系统关机时MIC_EN引脚输出低电平

### 6. 音频系统测试

#### ES8388编解码器测试
- [ ] **I2C通信测试**
  - 验证ES8388芯片I2C地址响应正常
  - SDA: GPIO_NUM_1, SCL: GPIO_NUM_2
  
- [ ] **I2S接口测试**
  - MCLK: GPIO_NUM_38
  - WS: GPIO_NUM_47
  - BCLK: GPIO_NUM_48
  - DIN: GPIO_NUM_21 (录音)
  - DOUT: GPIO_NUM_45 (播放)

### 7. 系统集成测试

#### 完整功能流程测试
- [ ] **冷启动测试**
  1. 上电启动
  2. 观察LED启动序列
  3. 验证模块自动启用
  4. 测试按键响应
  
- [ ] **热重启测试**
  1. 长按按键关机
  2. 观察关机LED序列
  3. 再次长按按键开机
  4. 验证系统恢复正常
  
- [ ] **错误恢复测试**
  - 测试异常情况下的系统恢复能力
  - 验证错误日志输出

### 8. 性能测试

#### 响应时间测试
- [ ] 按键响应时间 < 100ms
- [ ] LED切换时间 < 50ms
- [ ] 电源切换完成时间 < 2秒
- [ ] 模块启动时间 < 500ms

#### 功耗测试
- [ ] 开机状态功耗测量
- [ ] 关机状态功耗测量 (应小于1mA)
- [ ] LED不同亮度级别功耗

## 测试工具需求

### 硬件工具
- [ ] 万用表 (测量GPIO电平和功耗)
- [ ] 示波器 (检查信号时序)
- [ ] USB串口调试器

### 软件工具
- [ ] ESP-IDF串口监视器
- [ ] GPIO状态监控程序
- [ ] 音频测试工具

## 常见问题排查

### LED不亮
1. 检查GPIO配置是否正确
2. 验证LEDC定时器配置
3. 检查LED硬件连接

### 按键无响应
1. 检查GPIO模式配置
2. 验证按键硬件连接和上拉电阻
3. 检查按键消抖设置

### 模块无法启用
1. 检查使能引脚电平
2. 验证电源时序
3. 检查模块硬件连接

### 音频问题
1. 检查I2C通信
2. 验证I2S配置
3. 检查音频编解码器初始化

## 测试报告模板

```
YAKA Exploration V1 测试报告
==========================

测试日期: ____
测试人员: ____
硬件版本: ____
固件版本: ____

测试结果:
□ 通过  □ 失败  按键功能
□ 通过  □ 失败  LED控制
□ 通过  □ 失败  电源管理  
□ 通过  □ 失败  模块控制
□ 通过  □ 失败  音频系统
□ 通过  □ 失败  系统集成

问题记录:
______________

建议:
______________ 